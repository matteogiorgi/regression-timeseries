paragrafo 1:
```
# Research hypotheses supported by the literature

The objective of this work is to study which structural, qualitative, and locational characteristics of a residential property significantly affect its market price.

The *Ames Housing Dataset* provides detailed information on dwellings sold in Ames (Iowa) and is an updated version of the Boston Housing Dataset, already widely used in the housing econometrics literature. With its 2930, the *Ames Housing Dataset* offers a larger sample size and a more comprehensive set of features and it is better suited for modern statistical analysis.

Ames dataset includes physical size, construction details, quality ratings, and neighborhood indicators, all variables on which we formulate a series of hypotheses grounded in empirical findings from the real-estate and housing-econometrics literature.
```

paragrafo 1.1:
```
## Fundamentals variables and assumptions

We found that about 80% of the variation in residential sales price can be explained by simply taking into consideration the neighborhood and total square footage (`Total Bsmt SF` + `Gr Liv Area`) of the dwelling \cite{DeCock2011}.

According to our interpretation of the literature published by \cite{Han2023} and \cite{Zietz2008} plus our empirical reasoning, we consider the variables that significantly affect the sale price of a house are the following.
```

paragrafo 1.1.1:
```
### The overall quality of the house has a strong positive impact on sale price

Several studies show that global quality assessments summarise multiple latent characteristics (materials, workmanship, design), making them among the most informative predictors of house value.

\cite{Abdulhafedh2022} identifies `Overall Qual` as one of the most influential variables in explaining sale price in a multiple regression framework.

Similar evidence is reported in \cite{Han2023}, where overall quality consistently appears as the strongest determinant in both OLS and regularized regression models.
```

paragrafo 1.1.2:
```
### The above-ground living area (`Gr Liv Area`) is positively associated with the price of a house

The hedonic pricing literature traditionally recognises physical size as a primary contributor to housing value.

> The **hedonic pricing model** is an economic model that explains the price of a good as the sum (or combination) of the values of its attributes.
In other words, a complex good is “decomposed” into its components, and the total price reflects the contribution of each of them.
>
>The concept was introduced by Lancaster in 1966 in consumer theory and was first applied to housing prices by Rosen in 1974.

\cite{Abdulhafedh2022} highlights that the main livable area is among the variables with the highest explanatory power. Studies on the Ames dataset by \cite{Ye2024} and \cite{Han2023} similarly identify `Gr Liv Area` as one of the strongest continuous predictors.
```

paragrafo 1.1.3
```
### The total basement area (`Total Bsmt SF`) also increases house price, independently from the above-ground area

Basements provide additional functional space and generally correlate with larger, higher-value homes.

Multiple analyses of the Ames dataset \cite{Han2023} show that basement size maintains statistical significance even when controlling for other structural variables.
\cite{Abdulhafedh2022} also finds that basement-related features contribute substantially to the model fit.
```

paragrafo 1.1.4:
```
### Newer or recently renovated houses (`Year Built`, `Year Remod/Add`) tend to have higher sale prices

The literature on housing depreciation demonstrates that structural aging reduces property value unless offset by renovations.

According to \cite{Abdulhafedh2022}, both the construction year and the remodeling year play an important role in predicting sale prices.

Other studies on the Ames dataset reinforce this conclusion, noting that newer homes or homes with extensive remodeling command a price premium.
```

paragrafo 1.1.5:
```
### Higher-quality kitchens and exterior materials positively affect sale price

Studies in real-estate economics show that buyers are particularly sensitive to the quality of kitchens, bathrooms, and exterior finishes, as these elements influence both functionality and aesthetic appeal.

`Kitchen Qual` and `Exter Qual` are repeatedly found to be statistically significant predictors in analyses using the Ames dataset (\cite{Ye2024}, \cite{Abdulhafedh2022}).
Both variables capture qualitative assessments not reflected solely by house size.
```

paragrafo 1.1.6:
```
### Neighborhood characteristics significantly affect sale price, even after controlling for structural attributes.

Location remains one of the most important determinants of housing prices in hedonic models.

The Ames dataset includes a categorical variable (`Neighborhood`) that encodes proximity to schools, income areas, and local amenities.

Previous studies (\cite{DeCock2011}, \cite{Ye2024}) demonstrate that location dummies remain significant even in fully specified regression models.
```

paragrafo 1.2:
```
## Variables we remove

First, we remove the variables `Pool QC`, `Alley`, `Fence` and `Misc Feature` since they contain too many missing values (`NaN`).
The remaining variables would be available and ready for analysis but, as we have shown, including irrelevant variables increases the standard errors, which leads to less powerful significance tests and wider confidence intervals, and therefore to less precise statistical inference.

For this reason we have not considered many of the 82 explanatory variables, mainly because many of them refer to the same part of the house (such as `Bsmt Exposure`, `BsmtFin Type 1`, `BsmtFin Type 2` for the description of the basement), and therefore may be highly correlated and they generate high standard errors, also because we belive that some of them have a negligeable impact on sale prices. In order to obtain a more parsimonious model, with an higher $R^2$ adjusted and lower AIC and BIC we have decided to exclude these variables from the analysis.

An examlple of such variables are:

- `PID` is just an identification number wich does not provide any information about the house price
- `Lot Front` is the length of street connected to the property, which is not relevant for the price (on one hand a larger front may be better, on the other hand it may mean more noise and traffic)
- `Lot Shape` and `Land Contour` are less relevant than other locational attributes like neighborhood
- `Fireplaces` is the number of fireplaces, which is an outdated feature that does not affect the price significantly
- `FireplaceQu` is the quality of the fireplaces, which is of secondary importance compared to other quality features like kitchen and exterior quality
- `Roof Style` and `Roof Matl` are of secondary importance compared to other features such as quality and size
- `Condition 1` indicates the proximity to various conditions (e.g., arterial roads, railroads), but `Neighborhood` already captures location effects more comprehensively plus there is still the noise factor
```




paragrafo 2:
```
# Description of the Dataset

The analysis is based on the *Ames Housing Dataset*, a well-known real-estate dataset originally compiled by the Assessor’s Office of Ames, Iowa. It contains detailed information on residential properties sold between 2006 and 2010.

In its full version, the dataset includes 82 explanatory variables describing structural, qualitative, locational, and functional characteristics of each house.

For the purpose of this assignment, we selected a subset of the variables most commonly used in hedonic price models and supported by the literature.
```

paragrafo 2.1:
```
## General structure of the dataset

Each row of the dataset corresponds to a single residential property, while columns represent the attributes listed above.

Numerical variables are measured either in square feet or in calendar years, whereas qualitative assessments use an ordinal scale.
The dataset does not contain missing values for the variables selected for the analysis, and therefore no imputation was required in this step.

The dependent variable of the regression is `SalePrice`, expressed in US dollars and the selected explanatory variables fall into the four following categories.
```

paragrafo 2.1.1:
```
### Size and structural characteristics

These variables capture the physical dimensions of the dwelling:

- `Gr Liv Area`: above-ground living area (in square feet)
- `1st Flr SF`: first-floor area
- `Total Bsmt SF`: total basement area
- `Lot Area`: size of the lot
- `Full Bath`: number of full bathrooms
- `Garage Area`: size of the garage
- `Garage Cars`: garage capacity (number of cars)
- `Garage Yr Blt`: year the garage was built
- `Year Built`: construction year of the house
- `Year Remod/Add`: year of the most recent remodeling
- `Utilities`: type of utilities available

These attributes quantify the amount of usable space and the structural age of the property.
```

paragrafo 2.1.2:
```
### Quality assessments

The dataset includes several ordinal ratings assigned by professional assessors:

- `Overall Qual`: overall material and finish quality
- `Kitchen Qual`: quality of kitchen materials
- `ExterQual`: assessment of exterior materials and workmanship
- `BsmtQual`: quality of basement materials

These variables summarize qualitative features that are not captured by size alone.
```

paragrafo 2.1.3:
```
### Locational and timing information

- `Neighborhood`: categorical variable identifying the physical location within the city of Ames
- `MS Zoning`: categorical variable indicating the general zoning classification such as low‑density residential, medium‑density residential, or commercial
- `Year Sold`: year the property was sold

This variable incorporates locational amenities and neighbourhood-level characteristics that influence market value.
```





paragrafo 3:
```
# Model Specification and Estimation

The aim of this section is to construct a multiple linear regression model in order to explain the variation in the sale price of residential properties.

The dependent variable is `SalePrice`, while the set of regressors includes the structural, qualitative, and locational characteristics identified in the previous section.
```

paragrafo 3.1:
```
## Model Specification
The regression model is specified as follows:

$$
\begin{aligned}
\texttt{[SalePrice]}_i &= 
\beta_0
+ \beta_1\,\texttt{[Gr Liv Area]}_i
+ \beta_2\,\texttt{[1st Flr SF]}_i
+ \beta_3\,\texttt{[Total Bsmt SF]}_i\\
&\quad + \beta_4\,\texttt{[Lot Area]}_i
+ \beta_5\,\texttt{[Full Bath]}_i
+ \beta_6\,\texttt{[Garage Area]}_i\\
&\quad + \beta_7\,\texttt{[Garage Cars]}_i
+ \beta_8\,\texttt{[Garage Yr Blt]}_i
+ \beta_9\,\texttt{[Year Built]}_i\\
&\quad + \beta_{10}\,\texttt{[Year Remod/Add]}_i
+ \beta_{11}\,\texttt{[Utilities]}_i
+ \beta_{12}\,\texttt{[Overall Qual]}_i\\
&\quad + \beta_{13}\,\texttt{[Kitchen Qual]}_i
+ \beta_{14}\,\texttt{[Exter Qual]}_i
+ \beta_{15}\,\texttt{[Bsmt Qual]}_i\\
&\quad + \beta_{15}\,\texttt{[Neighborhood]}_i
+ \beta_{16}\,\texttt{[MS Zoning]}_i
+ \beta_{16}\,\texttt{[Year Sold]}_i
+ \varepsilon_i
\end{aligned}
$$

where:

- $\beta_0$ is the intercept
- $\beta$'s denote the coefficients associated with each regressor
- $\varepsilon_i$ is the error term capturing unobserved factors
- the `Neighborhood` variable is treated as a categorical factor and encoded through dummy variables
```

paragrafo 3.2:
```
## Model Assumptions

Our multiple linear regression model is estimated under the following assumptions:

- linearity of the *conditional mean*
$$
\mathbb{E}[\varepsilon_i \mid X_i] = 0
\ \Longleftrightarrow\ 
\mathbb{E}[Y_i \mid X_i]
  = \beta_0 + \beta_1 X_{i1} + \cdots + \beta_p X_{ip}
$$
This assumption implies that all systematic variation in the dependent variable is captured by the regressors.

- *independent and identically distributed* observations
$$
(Y_i, X_i) \;\perp\!\!\!\perp\; (Y_j, X_j)
\quad \text{for } i \neq j
$$
and all observations are drawn from the same population distribution. This corresponds to the standard *i.i.d.* sampling framework.

- finite *fourth moments*
$$
\mathbb{E}[X_{ik}^4] < \infty
\qquad\text{and}\qquad
\mathbb{E}[\varepsilon_i^4] < \infty
$$
This condition ensures the applicability of asymptotic results and prevents extreme observations from dominating the estimation.
```

paragrafo 3.3:
```
## R code

Here we list the full code used for the analysis with all comments and explanations.
```

```
setwd("C:/Users/enric/OneDrive/Documenti/Bank accounting")
ames <- read.csv("Amespug.csv")

# Prima rinominiamo le variabili con spazi in nomi più comodi
install.packages(dyplr)
library(dplyr)
ames_clean <- ames %>%
  rename(
    GrLivArea = `Gr.Liv.Area`,
    FirstFlrSF = `X1st.Flr.SF`,
    TotalBsmtSF = `Total.Bsmt.SF`,
    LotArea = `Lot.Area`,
    FullBath = `Full.Bath`,
    GarageArea = `Garage.Area`,
    GarageCars = `Garage.Cars`,
    GarageYrBlt = `Garage.Yr.Blt`,
    YearBuilt = `Year.Built`,
    YearRemodAdd = `Year.Remod.Add`,
    OverallQual = `Overall.Qual`,
    KitchenQual = `Kitchen.Qual`,
    ExterQual = `Exter.Qual`,
    BsmtQual = `Bsmt.Qual`,
    Neighborhood = `Neighborhood`,
)

# Regressione lineare
model <- lm(
  SalePrice ~ GrLivArea + FirstFlrSF + TotalBsmtSF + LotArea +
    FullBath + GarageArea + GarageCars + GarageYrBlt +
    YearBuilt + YearRemodAdd + OverallQual +
    KitchenQual + ExterQual + BsmtQual +
    Neighborhood,
  data = ames_clean
)

# Risultati

summary(model)
```

paragrafo 3.4, 3.4.1, 3.4.2
```
## Interpretation of the regression output

The OLS regression is estimated on 2,770 observations.  
The dependent variable is `SalePrice`, while the regressors include size variables, quality indicators, age/renovation variables and a set of dummies for neighbourhood, zoning and utilities.

### Overall fit of the model

The model displays a relatively high goodness of fit:

- $\texttt{R-squared} = 0.855$
- $\texttt{Adjusted R-squared} = 0.852$

This means that about 85% of the variation in house prices in the sample is explained by the regressors included in the model.  

The `F-statistic` is 280.9 with a p-value essentially equal to zero, so the null hypothesis that all slope coefficients are jointly equal to zero is strongly rejected. Taken together, the explanatory variables have a statistically significant impact on `SalePrice`.

### Interpretation of the main coefficients

The first group of coefficients (`x1`–`x11`) corresponds to the "core" numeric regressors (size, age, quality):

- \colorbox{yellow}{$\texttt{x1} \approx 44.4$} (`Gr Liv Area`) is positive and highly significant. Interpreting it as the coefficient on above-ground living area, it suggests that, ceteris paribus, an additional square foot of living area increases the sale price by about 44 dollars.
- \colorbox{yellow}{$\texttt{x3} \approx 23.4$} (`Total Bsmt SF`) is also positive and highly significant, indicating that extra basement area is rewarded in the market (around 23 dollars per square foot)
- \colorbox{yellow}{$\texttt{x4} \approx 0.62$} (`Lot Area`) is positive and significant: larger lots are associated with higher prices, although the marginal effect per square foot is much smaller than for interior living space or basement area
- \colorbox{yellow}{$\texttt{x5} \approx –3,756$} (`Full Bath`) is negative and statistically significant at the 5% level. This is somewhat counter-intuitive, but it can be explained by multicollinearity: once we condition on total size and quality, adding one more full bathroom at fixed size may capture houses with a different layout rather than genuinely higher quality
- \colorbox{yellow}{$\texttt{x6} \approx 16.6$} (`Garage Area`) and \colorbox{yellow}{$\texttt{x7} \approx 7,228$} (`Garage Cars`) are both positive and significant, meaning that larger garages and the capacity to park more cars are rewarded by the market
- \colorbox{yellow}{$\texttt{x8}$} (`Garage Yr Blt`) is not statistically significant (p $\approx 0.41$), suggesting that, after controlling for the other variables, the construction year of the garage does not have a clear marginal effect
- \colorbox{yellow}{$\texttt{x9} \approx 247.3$} (`Year Built`) and \colorbox{yellow}{$\texttt{x10} \approx 259.2$} (`Year Remod/Add`) are positive and highly significant: newer houses and more recently renovated properties tend to sell at higher prices, in line with the idea that buyers pay a premium for newer structures and recent improvements
- \colorbox{yellow}{$\texttt{x11} \approx 12,610$} (`Overall Qual`) is positive and extremely significant. A one-point increase in the overall quality rating is associated with roughly 12 or 13 thousand dollars more in sale price, everything else being equal. **This confirms the strong role of quality emphasised in the hedonic pricing literature**

The next coefficients (`x12`, `x13`, `x15`–`x20`, `x22`, ..., `x57`) correspond to dummy variables created from `Kitchen Qual`, `Exter Qual` and `Bsmt Qual`.
Most of these are negative and highly significant, because the baseline category is the highest quality level, and the dummies measure the price discount associated with having a lower quality relative to that baseline.  
In other words, houses with worse kitchen, exterior or basement quality sell at systematically lower prices.

The block of coefficients starting around `x28`–`x41` corresponds mostly to `Neighborhood` dummies.  
Some neighbourhoods show large positive and significant coefficients (for example, `x32`, `x40`, `x41`, `x47`, `x48`, `x49`), indicating that these areas command sizeable price premia relative to the omitted reference neighbourhood.  
Other neighbourhood coefficients are not statistically significant, suggesting that, after controlling for structural and quality characteristics, their effect on price is not clearly distinguishable from zero.

Finally, the last coefficients (approximately `x50`–`x57`) represent dummies for `MS Zoning` and `Utilities`.  
Most of them are not statistically significant (p-values well above 0.05), which indicates that, in this specification, zoning and utilities categories do not add much explanatory power once size, quality and neighbourhood are already in the model.
```


paragrafo 4:
```
# Diagnostic analysis
```

paragrafo 4.1:
```
## Perfect colinearity

Before proceeding with the regression diagnostics, we checked whether any exact linear relationships existed among the regressors. In the *Ames Housing Dataset*, the variable `Gr Liv Area` (above-ground living area) we suspect might be, by construction, equal to the sum of other area-related variables:

$$ 
\texttt{Gr Liv Area} \;=\; \texttt{1st Flr SF} \;+\; \texttt{2nd Flr SF} \;+\; \texttt{Low Qual Fin SF}
$$

If this relation holds exactly, including all four variables simultaneously in the regression would generate perfect multicollinearity, making the OLS estimator not uniquely defined. This means that the design matrix would be rank-deficient, and therefore the inverse of $X'X$ required for the OLS formula could not be computed. Let's verifie this identity in the data by computing the difference:

$$ 
d_i \;=\; \texttt{[Gr Liv Area]}_i \;-\; \bigl(\texttt{[1st Flr SF]}_i + \texttt{[2nd Flr SF]}_i + \texttt{[Low Qual Fin SF]}_i\bigr) \quad \forall i
$$
```

codice R:
```
#multicollinearità perfetta
ames_multicollineareperfetto <- ames %>%
  rename(
    GrLivArea = `Gr.Liv.Area`,
    FirstFlrSF = `X1st.Flr.SF`,
    SecondFlrSF = `X2nd.Flr.SF`,
    LowQualFinSF = `Low.Qual.Fin.SF`,
    TotalBsmtSF = `Total.Bsmt.SF`,
    LotArea = `Lot.Area`,
    FullBath = `Full.Bath`,
    GarageArea = `Garage.Area`,
    GarageCars = `Garage.Cars`,
    GarageYrBlt = `Garage.Yr.Blt`,
    YearBuilt = `Year.Built`,
    YearRemodAdd = `Year.Remod.Add`,
    OverallQual = `Overall.Qual`,
    KitchenQual = `Kitchen.Qual`,
    ExterQual = `Exter.Qual`,
    BsmtQual = `Bsmt.Qual`,
    Neighborhood = `Neighborhood`,
    MSZoning = `MS.Zoning`,
    Utilities = `Utilities`,
  )
#creo modello con multicollinearità perfetta
modelmulticollperf <- lm(
  SalePrice ~ GrLivArea + FirstFlrSF + SecondFlrSF + LowQualFinSF +
    TotalBsmtSF + LotArea + FullBath + GarageArea + GarageCars +
    GarageYrBlt + YearBuilt + YearRemodAdd + OverallQual +
    KitchenQual + ExterQual + BsmtQual +
    Neighborhood + MSZoning + Utilities,
  data = ames_multicollineareperfetto
)

summary(modelmulticollperf)
```

output:
```
Call:
lm(formula = SalePrice ~ GrLivArea + FirstFlrSF + SecondFlrSF + 
    LowQualFinSF + TotalBsmtSF + LotArea + FullBath + GarageArea + 
    GarageCars + GarageYrBlt + YearBuilt + YearRemodAdd + OverallQual + 
    KitchenQual + ExterQual + BsmtQual + Neighborhood + MSZoning + 
    Utilities, data = ames_multicollineareperfetto)

Residuals:
    Min      1Q  Median      3Q     Max 
-457007  -12709     135   12330  233868 

Coefficients: (1 not defined because of singularities)
                      Estimate Std. Error t value Pr(>|t|)    
(Intercept)         -7.548e+05  1.344e+05  -5.617 2.15e-08 ***
GrLivArea            2.280e+01  1.433e+01   1.591 0.111753    
FirstFlrSF           2.976e+01  1.484e+01   2.005 0.045045 *  
SecondFlrSF          2.088e+01  1.441e+01   1.449 0.147467    
LowQualFinSF                NA         NA      NA       NA    
TotalBsmtSF          9.048e+00  3.423e+00   2.644 0.008251 ** 
LotArea              6.469e-01  8.584e-02   7.535 6.64e-14 ***
FullBath            -3.158e+03  1.688e+03  -1.871 0.061456 .  
GarageArea           1.807e+01  6.767e+00   2.670 0.007621 ** 
GarageCars           7.132e+03  1.962e+03   3.635 0.000283 ***
GarageYrBlt         -6.638e+01  4.847e+01  -1.370 0.170952    
YearBuilt            2.351e+02  5.839e+01   4.026 5.84e-05 ***
YearRemodAdd         2.398e+02  4.571e+01   5.246 1.68e-07 ***
OverallQual          1.197e+04  8.430e+02  14.201  < 2e-16 ***
KitchenQualFa       -3.396e+04  5.864e+03  -5.792 7.77e-09 ***
KitchenQualGd       -2.793e+04  3.191e+03  -8.751  < 2e-16 ***
KitchenQualPo       -5.436e+04  3.132e+04  -1.736 0.082768 .  
KitchenQualTA       -3.386e+04  3.574e+03  -9.473  < 2e-16 ***
ExterQualFa         -3.919e+04  9.015e+03  -4.347 1.43e-05 ***
ExterQualGd         -2.738e+04  4.105e+03  -6.670 3.10e-11 ***
ExterQualTA         -2.738e+04  4.653e+03  -5.884 4.50e-09 ***
BsmtQualFa          -3.345e+04  5.268e+03  -6.350 2.53e-10 ***
BsmtQualGd          -3.063e+04  2.828e+03 -10.834  < 2e-16 ***
BsmtQualPo          -2.087e+04  2.375e+04  -0.879 0.379561    
BsmtQualTA          -3.018e+04  3.538e+03  -8.531  < 2e-16 ***
NeighborhoodBlueste  1.818e+03  1.190e+04   0.153 0.878596    
NeighborhoodBrDale  -6.610e+03  9.274e+03  -0.713 0.476057    
NeighborhoodBrkSide  9.622e+03  7.927e+03   1.214 0.224937    
NeighborhoodClearCr  2.016e+04  7.957e+03   2.534 0.011350 *  
NeighborhoodCollgCr  8.819e+03  6.219e+03   1.418 0.156334    
NeighborhoodCrawfor  2.893e+04  7.168e+03   4.036 5.59e-05 ***
NeighborhoodEdwards -9.874e+03  6.897e+03  -1.432 0.152378    
NeighborhoodGilbert  4.060e+03  6.473e+03   0.627 0.530553    
NeighborhoodGreens   1.314e+04  1.245e+04   1.056 0.291225    
NeighborhoodGrnHill  1.496e+05  3.131e+04   4.778 1.87e-06 ***
NeighborhoodIDOTRR   7.019e+03  8.831e+03   0.795 0.426816    
NeighborhoodLandmrk -4.624e+03  3.194e+04  -0.145 0.884917    
NeighborhoodMeadowV  3.505e+01  9.530e+03   0.004 0.997066    
NeighborhoodMitchel  2.690e+03  6.870e+03   0.392 0.695408    
NeighborhoodNAmes    2.899e+03  6.582e+03   0.440 0.659643    
NeighborhoodNoRidge  5.950e+04  7.141e+03   8.331  < 2e-16 ***
NeighborhoodNPkVill -6.143e+03  8.912e+03  -0.689 0.490667    
NeighborhoodNridgHt  2.992e+04  6.556e+03   4.563 5.27e-06 ***
NeighborhoodNWAmes   2.114e+03  6.717e+03   0.315 0.752968    
NeighborhoodOldTown -4.446e+02  7.991e+03  -0.056 0.955630    
NeighborhoodSawyer   3.732e+03  6.870e+03   0.543 0.586997    
NeighborhoodSawyerW  2.383e+03  6.645e+03   0.359 0.719915    
NeighborhoodSomerst  1.774e+04  7.544e+03   2.351 0.018796 *  
NeighborhoodStoneBr  4.946e+04  7.379e+03   6.702 2.51e-11 ***
NeighborhoodSWISU   -6.786e+02  8.497e+03  -0.080 0.936349    
NeighborhoodTimber   1.431e+04  6.992e+03   2.046 0.040811 *  
NeighborhoodVeenker  2.460e+04  8.682e+03   2.833 0.004647 ** 
MSZoningFV           1.673e+04  1.134e+04   1.476 0.140012    
MSZoningI (all)     -4.499e+04  3.208e+04  -1.402 0.160907    
MSZoningRH           1.416e+04  1.213e+04   1.167 0.243304    
MSZoningRL           2.346e+04  9.938e+03   2.361 0.018316 *  
MSZoningRM           1.322e+04  9.438e+03   1.401 0.161369    
UtilitiesNoSeWa     -3.954e+04  3.092e+04  -1.279 0.201024    
UtilitiesNoSewr     -6.795e+04  3.083e+04  -2.204 0.027583 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 30520 on 2647 degrees of freedom
  (225 observations deleted due to missingness)
Multiple R-squared:  0.8558,	Adjusted R-squared:  0.8527 
F-statistic: 275.6 on 57 and 2647 DF,  p-value: < 2.2e-16
```



paragrafo 4.2:
```
## Imperfect multicollinearity: variance inflation factors

After ruling out exact linear dependencies, we investigated imperfect multicollinearity among some regressors that are a priori expected to be strongly related. In particular, we focused on the following pairs of variables:

- `Garage Area` and `Garage Cars`
- `Year Built` and `Garage Yr Blt`
- `1st Flr SF` and `Total Bsmt SF`
- `Gr Liv Area` and `Full Bath`
- `Year Remod/Add` and `Year Built`

For each of these regressor, we computed the *Variance Inflation Factor* (VIF). For a given regressor $X_j$, the VIF is defined as

$$
\text{VIF}_j = \frac{1}{1 - R_j^2}
$$

where $R_j^2$ is the coefficient of determination from the regression of $X_j$ on all the remaining regressors. Large VIF values indicate that the variable is highly correlated with the others and that its coefficient may be imprecisely estimated.
```

codice R:
```
library(performance)
vif_values <- check_collinearity(model)
print(vif_values)
```

output:
```
Low Correlation

         Term  VIF     VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
    GrLivArea 3.04 [ 2.86,  3.24]     1.74      0.33     [0.31, 0.35]
      LotArea 1.36 [ 1.30,  1.43]     1.17      0.74     [0.70, 0.77]
     FullBath 2.49 [ 2.35,  2.65]     1.58      0.40     [0.38, 0.43]
   GarageArea 4.64 [ 4.35,  4.96]     2.15      0.22     [0.20, 0.23]
   GarageCars 4.67 [ 4.37,  4.99]     2.16      0.21     [0.20, 0.23]
  GarageYrBlt 4.41 [ 4.14,  4.72]     2.10      0.23     [0.21, 0.24]
 YearRemodAdd 2.54 [ 2.39,  2.69]     1.59      0.39     [0.37, 0.42]
  OverallQual 3.74 [ 3.51,  3.99]     1.93      0.27     [0.25, 0.28]

Moderate Correlation

        Term  VIF     VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
  FirstFlrSF 6.12 [ 5.72,  6.55]     2.47      0.16     [0.15, 0.17]
 TotalBsmtSF 5.69 [ 5.33,  6.09]     2.39      0.18     [0.16, 0.19]
   YearBuilt 8.45 [ 7.88,  9.06]     2.91      0.12     [0.11, 0.13]
 KitchenQual 5.17 [ 4.84,  5.53]     2.27      0.19     [0.18, 0.21]
   ExterQual 6.26 [ 5.85,  6.70]     2.50      0.16     [0.15, 0.17]
    BsmtQual 7.14 [ 6.66,  7.65]     2.67      0.14     [0.13, 0.15]

High Correlation

         Term   VIF     VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
 Neighborhood 41.33 [38.42, 44.46]     6.43      0.02     [0.02, 0.03]
```




paragrafo 4.3:
```
## Structural stability: Chow test around the 2008 financial crisis

The period covered by the dataset includes the years surrounding the 2008 financial crisis, which may have affected the housing market and, consequently, the relationship between the explanatory variables and `SalePrice`. To assess whether the regression coefficients are stable over time, we performed a Chow test for a structural break with respect to the year of sale (`Yr Sold`).

We split the sample into two subperiods:

- pre-crisis period: transactions in 2006–2007
- crisis and post-crisis period: transactions in 2008–2010

Let $RSS_P$ and $RSS_C$ denote the residual sum of squares of the model estimated separately on the pre-crisis and crisis/post-crisis subsamples, and let $RSS_{P \cup C}$ be the residual sum of squares of the model estimated on the full pooled sample. Denoting by $k$ the number of estimated parameters (including the intercept) and by $n_P$ and $n_C$ the sample sizes of the two subsamples, the Chow test statistic is:

$$
F \;=\; \frac{(RSS_{P\cup C} - \bigl(RSS_P + RSS_C\bigr))/k}
            {(RSS_P + RSS_C)/(\,n_P + n_C - 2k\,)}
$$

which under the null hypothesis of parameter stability follows an F-distribution with $(k, n_P + n_C -2k)$ degrees of freedom.
```

Codice R:
```
#2:Test di Chow
library(sandwich)
library(strucchange)

ames_clean$OverallQual <- ordered(ames_clean$OverallQual, levels = 1:10)

ames_clean$KitchenQual <- ordered(
  ames_clean$KitchenQual,
  levels = c("Po", "Fa", "TA", "Gd", "Ex")
)

ames_clean$ExterQual <- ordered(
  ames_clean$ExterQual,
  levels = c("Po", "Fa", "TA", "Gd", "Ex")
)

ames_clean$BsmtQual <- ordered(
  ames_clean$BsmtQual,
  levels = c("Po", "Fa", "TA", "Gd", "Ex")
)

ames_ordered <- ames_clean[order(ames_clean$Yr.Sold), ]
modelordered <- lm(
  SalePrice ~ GrLivArea + FirstFlrSF + TotalBsmtSF + LotArea +
    FullBath + GarageArea + GarageCars + GarageYrBlt +
    YearBuilt + YearRemodAdd + OverallQual +
    KitchenQual + ExterQual + BsmtQual ,
  data = ames_ordered
)

break_point <- min(which(ames_ordered$Yr.Sold == 2008))
chow_test <- sctest(modelordered, type = "Chow", point = break_point)
print(chow_test)

#vediamo se intercetta cambia
# Modello pre-2008
model_pre2008 <- lm(
  SalePrice ~ GrLivArea + FirstFlrSF + TotalBsmtSF + LotArea +
    FullBath + GarageArea + GarageCars + GarageYrBlt +
    YearBuilt + YearRemodAdd + OverallQual +
    KitchenQual + ExterQual + BsmtQual +
    Neighborhood ,
  data = subset(ames_clean, Yr.Sold <= 2008)
)

#modello post-2008
model_post2008 <- lm(
  SalePrice ~ GrLivArea + FirstFlrSF + TotalBsmtSF + LotArea +
    FullBath + GarageArea + GarageCars + GarageYrBlt +
    YearBuilt + YearRemodAdd + OverallQual +
    KitchenQual + ExterQual + BsmtQual +
    Neighborhood ,
  data = subset(ames_clean, Yr.Sold > 2008)
)

summary(model_pre2008)
summary(model_post2008)
```

output:
```

	M-fluctuation test

data:  modelordered
f(efp) = 1.3035, p-value = 0.8746


Call:
lm(formula = SalePrice ~ GrLivArea + FirstFlrSF + TotalBsmtSF + 
    LotArea + FullBath + GarageArea + GarageCars + GarageYrBlt + 
    YearBuilt + YearRemodAdd + OverallQual + KitchenQual + ExterQual + 
    BsmtQual + Neighborhood, data = subset(ames_clean, Yr.Sold <= 
    2008))

Residuals:
    Min      1Q  Median      3Q     Max 
-403392  -13136     131   11787  214650 

Coefficients:
                      Estimate Std. Error t value Pr(>|t|)    
(Intercept)         -6.937e+05  1.634e+05  -4.244 2.31e-05 ***
GrLivArea            3.866e+01  2.615e+00  14.786  < 2e-16 ***
FirstFlrSF           1.287e+01  4.663e+00   2.760 0.005832 ** 
TotalBsmtSF         -3.737e+00  4.327e+00  -0.864 0.387894    
LotArea              4.600e-01  1.135e-01   4.053 5.27e-05 ***
FullBath             1.724e+03  2.175e+03   0.792 0.428263    
GarageArea           2.492e+01  8.622e+00   2.890 0.003898 ** 
GarageCars           6.626e+03  2.523e+03   2.627 0.008701 ** 
GarageYrBlt         -9.153e+01  5.892e+01  -1.554 0.120457    
YearBuilt            2.305e+02  7.336e+01   3.143 0.001703 ** 
YearRemodAdd         2.582e+02  5.885e+01   4.387 1.22e-05 ***
OverallQual.L        1.323e+05  1.234e+04  10.721  < 2e-16 ***
OverallQual.Q        4.250e+04  1.019e+04   4.170 3.20e-05 ***
OverallQual.C        1.877e+04  8.542e+03   2.198 0.028114 *  
OverallQual^4       -5.817e+03  7.478e+03  -0.778 0.436716    
OverallQual^5       -4.388e+03  6.401e+03  -0.685 0.493140    
OverallQual^6       -4.107e+03  4.791e+03  -0.857 0.391431    
OverallQual^7        7.681e+02  3.122e+03   0.246 0.805696    
OverallQual^8        4.746e+02  1.906e+03   0.249 0.803382    
KitchenQual.L        1.752e+04  5.283e+03   3.316 0.000932 ***
KitchenQual.Q        1.070e+04  3.697e+03   2.894 0.003856 ** 
KitchenQual.C        8.767e+02  2.057e+03   0.426 0.669952    
ExterQual.L          1.198e+04  8.704e+03   1.377 0.168763    
ExterQual.Q         -1.018e+04  6.259e+03  -1.626 0.104100    
ExterQual.C          5.139e+03  3.142e+03   1.636 0.102065    
BsmtQual.L           2.724e+04  1.535e+04   1.775 0.076124 .  
BsmtQual.Q           1.094e+04  1.259e+04   0.869 0.384779    
BsmtQual.C           9.503e+03  7.981e+03   1.191 0.233956    
BsmtQual^4           6.458e+03  3.767e+03   1.714 0.086650 .  
NeighborhoodBlueste -1.152e+04  1.774e+04  -0.649 0.516293    
NeighborhoodBrDale  -3.004e+04  1.085e+04  -2.769 0.005685 ** 
NeighborhoodBrkSide -6.901e+03  9.343e+03  -0.739 0.460245    
NeighborhoodClearCr  1.883e+04  9.993e+03   1.884 0.059682 .  
NeighborhoodCollgCr  2.433e+03  7.694e+03   0.316 0.751911    
NeighborhoodCrawfor  2.251e+04  8.863e+03   2.540 0.011165 *  
NeighborhoodEdwards -2.209e+04  8.528e+03  -2.590 0.009680 ** 
NeighborhoodGilbert -3.252e+03  8.072e+03  -0.403 0.687107    
NeighborhoodGreens  -1.770e+03  1.627e+04  -0.109 0.913385    
NeighborhoodGrnHill  1.452e+05  3.260e+04   4.454 8.96e-06 ***
NeighborhoodIDOTRR  -1.708e+04  9.579e+03  -1.783 0.074754 .  
NeighborhoodLandmrk -2.577e+04  3.268e+04  -0.789 0.430461    
NeighborhoodMeadowV -2.591e+04  1.124e+04  -2.306 0.021231 *  
NeighborhoodMitchel -5.987e+03  8.607e+03  -0.696 0.486792    
NeighborhoodNAmes   -4.032e+03  8.188e+03  -0.492 0.622514    
NeighborhoodNoRidge  5.241e+04  9.006e+03   5.819 7.01e-09 ***
NeighborhoodNPkVill -1.232e+04  1.314e+04  -0.937 0.348816    
NeighborhoodNridgHt  2.089e+04  8.293e+03   2.519 0.011867 *  
NeighborhoodNWAmes  -2.054e+03  8.367e+03  -0.245 0.806121    
NeighborhoodOldTown -1.904e+04  9.026e+03  -2.110 0.035025 *  
NeighborhoodSawyer  -5.718e+03  8.546e+03  -0.669 0.503501    
NeighborhoodSawyerW -2.554e+03  8.476e+03  -0.301 0.763235    
NeighborhoodSomerst  1.201e+03  7.900e+03   0.152 0.879193    
NeighborhoodStoneBr  3.683e+04  9.288e+03   3.966 7.61e-05 ***
NeighborhoodSWISU   -1.053e+04  1.089e+04  -0.967 0.333719    
NeighborhoodTimber   1.393e+04  8.643e+03   1.612 0.107109    
NeighborhoodVeenker  2.322e+04  1.033e+04   2.248 0.024682 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 31660 on 1738 degrees of freedom
  (147 observations deleted due to missingness)
Multiple R-squared:  0.8485,	Adjusted R-squared:  0.8438 
F-statistic:   177 on 55 and 1738 DF,  p-value: < 2.2e-16


Call:
lm(formula = SalePrice ~ GrLivArea + FirstFlrSF + TotalBsmtSF + 
    LotArea + FullBath + GarageArea + GarageCars + GarageYrBlt + 
    YearBuilt + YearRemodAdd + OverallQual + KitchenQual + ExterQual + 
    BsmtQual + Neighborhood, data = subset(ames_clean, Yr.Sold > 
    2008))

Residuals:
    Min      1Q  Median      3Q     Max 
-113146  -11817    1258   11907  184243 

Coefficients:
                      Estimate Std. Error t value Pr(>|t|)    
(Intercept)         -1.244e+06  2.032e+05  -6.121 1.41e-09 ***
GrLivArea            5.535e+01  3.137e+00  17.644  < 2e-16 ***
FirstFlrSF          -4.432e+00  5.614e+00  -0.789 0.430122    
TotalBsmtSF          3.491e+01  5.109e+00   6.834 1.57e-11 ***
LotArea              1.049e+00  1.163e-01   9.015  < 2e-16 ***
FullBath            -8.670e+03  2.432e+03  -3.565 0.000385 ***
GarageArea           9.786e-01  9.845e+00   0.099 0.920842    
GarageCars           5.247e+03  2.842e+03   1.846 0.065211 .  
GarageYrBlt          2.471e+01  7.899e+01   0.313 0.754509    
YearBuilt            3.536e+02  8.759e+01   4.037 5.90e-05 ***
YearRemodAdd         2.793e+02  6.515e+01   4.287 2.02e-05 ***
OverallQual.L        1.001e+05  1.345e+04   7.441 2.44e-13 ***
OverallQual.Q        4.462e+04  1.093e+04   4.083 4.86e-05 ***
OverallQual.C        1.616e+04  8.763e+03   1.845 0.065418 .  
OverallQual^4        2.036e+02  7.863e+03   0.026 0.979352    
OverallQual^5       -4.488e+03  6.993e+03  -0.642 0.521227    
OverallQual^6       -3.153e+03  5.289e+03  -0.596 0.551161    
OverallQual^7        1.128e+01  3.478e+03   0.003 0.997412    
OverallQual^8        9.944e+02  2.130e+03   0.467 0.640657    
KitchenQual.L        2.728e+04  1.759e+04   1.551 0.121299    
KitchenQual.Q        8.326e+03  1.467e+04   0.568 0.570507    
KitchenQual.C        3.240e+03  9.549e+03   0.339 0.734432    
KitchenQual^4        2.370e+03  4.679e+03   0.506 0.612642    
ExterQual.L          2.726e+04  8.360e+03   3.260 0.001156 ** 
ExterQual.Q          1.413e+04  5.862e+03   2.410 0.016169 *  
ExterQual.C          7.616e+03  3.011e+03   2.529 0.011622 *  
BsmtQual.L           6.495e+03  5.697e+03   1.140 0.254571    
BsmtQual.Q           8.444e+03  3.568e+03   2.366 0.018179 *  
BsmtQual.C          -1.227e+03  2.187e+03  -0.561 0.574775    
NeighborhoodBlueste  6.948e+03  1.412e+04   0.492 0.622800    
NeighborhoodBrDale   1.225e+04  1.309e+04   0.936 0.349704    
NeighborhoodBrkSide  2.783e+04  1.146e+04   2.428 0.015390 *  
NeighborhoodClearCr  3.002e+04  1.207e+04   2.488 0.013039 *  
NeighborhoodCollgCr  1.826e+04  9.608e+03   1.900 0.057769 .  
NeighborhoodCrawfor  4.416e+04  1.102e+04   4.007 6.68e-05 ***
NeighborhoodEdwards  1.093e+04  1.057e+04   1.034 0.301540    
NeighborhoodGilbert  1.947e+04  9.870e+03   1.973 0.048829 *  
NeighborhoodGreens   2.904e+04  1.764e+04   1.646 0.100111    
NeighborhoodIDOTRR   1.492e+04  1.273e+04   1.172 0.241389    
NeighborhoodMeadowV  4.914e+03  1.359e+04   0.362 0.717767    
NeighborhoodMitchel  1.888e+04  1.041e+04   1.813 0.070182 .  
NeighborhoodNAmes    1.810e+04  1.008e+04   1.795 0.072940 .  
NeighborhoodNoRidge  5.200e+04  1.100e+04   4.729 2.64e-06 ***
NeighborhoodNPkVill  1.624e+04  1.176e+04   1.381 0.167502    
NeighborhoodNridgHt  3.271e+04  1.006e+04   3.252 0.001190 ** 
NeighborhoodNWAmes   1.722e+04  1.025e+04   1.680 0.093289 .  
NeighborhoodOldTown  1.097e+04  1.120e+04   0.979 0.327649    
NeighborhoodSawyer   2.200e+04  1.054e+04   2.087 0.037202 *  
NeighborhoodSawyerW  1.575e+04  9.929e+03   1.586 0.113146    
NeighborhoodSomerst  2.729e+04  9.755e+03   2.797 0.005267 ** 
NeighborhoodStoneBr  5.049e+04  1.165e+04   4.334 1.64e-05 ***
NeighborhoodSWISU    2.222e+04  1.228e+04   1.809 0.070806 .  
NeighborhoodTimber   7.131e+03  1.093e+04   0.652 0.514353    
NeighborhoodVeenker  1.833e+04  1.598e+04   1.147 0.251660    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 25200 on 857 degrees of freedom
  (78 observations deleted due to missingness)
Multiple R-squared:  0.9026,	Adjusted R-squared:  0.8966 
F-statistic: 149.9 on 53 and 857 DF,  p-value: < 2.2e-16
```